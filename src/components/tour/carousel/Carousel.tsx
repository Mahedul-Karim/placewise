"use client";

import { sliderFunction } from "@/components/util/SliderFunction";
import React, { useEffect, useRef, useState } from "react";
import { RxCross1 } from "react-icons/rx";
type Props = {
  images?: {
    id: string;
    tourName: string;
    publicId: string;
    url: string;
  }[];
};

const Carousel: React.FC<Props> = ({ images }) => {
  const imageContainer = useRef<any>();
  const image = [
    {
      url: "http://res.cloudinary.com/dleogo48u/image/upload/v1703249147/avatars/hgnvoclhxbvkduzm6hnn.webp",
      num: 1,
    },

    {
      url: "http://res.cloudinary.com/dleogo48u/image/upload/v1703249145/avatars/nmetlpqnvw1js737ardl.webp",
      num: 2,
    },
    {
      url: "http://res.cloudinary.com/dleogo48u/image/upload/v1703249146/avatars/foy2txonmltozfw7evnb.webp",
      num: 3,
    },
    {
      url: "http://res.cloudinary.com/dleogo48u/image/upload/v1703249148/avatars/xdbwhatgzp20rzuxrves.webp",
      num: 4,
    },
    {
      url: "http://res.cloudinary.com/dleogo48u/image/upload/v1703249149/avatars/mq1fj4x2ecfcumhrfc0a.webp",
      num: 5,
    },
  ];

  let count = 0;

  const nextSlide = () => {
    const images = imageContainer.current.childNodes;
    if (count === images.length) {
      count = 1;
    } else {
      count++;
    }

    sliderFunction(images, count);
  };

  const prevClick = () => {
    const images = imageContainer.current.childNodes;

    if (count === 0) {
      count = images.length - 1;
    } else {
      count--;
    }
    sliderFunction(images, count);
  };

  return (
    <div className="fixed w-full h-full left-0 top-0 bg-[#000000] backdrop-blur-[2px] z-[99999] flex items-center justify-center flex-col">
      <button className="absolute top-[20px] right-[20px] bg-white rounded-md flex items-center justify-center p-2 w-10 h-10">
        <RxCross1 />
      </button>
      <div
        className="relative w-full h-full flex items-center justify-center shrink-0 translate-x-[5%] image-slider"
        ref={imageContainer}
      >
        {image?.map((image, i) => (
          <img
            src={image.url}
            alt="featured image"
            className={`block max-w-[250px] max-h-[150px] 400px:max-w-[280px] 400px:max-h-[140px] sm:max-h-[250px] md:max-h-[350px] object-cover sm:max-w-[350px] md:max-w-[450px] absolute shadow-md transition-all duration-300 image carousel-item-${
              i + 1
            }`}
            key={i}
          />
        ))}
      </div>
      <button className="bg-white" onClick={nextSlide}>
        Click me
      </button>
    </div>
  );
};

export default Carousel;
